<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" th:href="@{/assets/images/favicon.ico}" type="image/x-icon">
    <title>Admin System</title>

    <!-- Bootstrap 5 CSS -->
    <link th:rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/5.3.6/dist/css/bootstrap.min.css}"/>

    <!-- Font Awesome -->
    <link th:rel="stylesheet" type="text/css" th:href="@{/webjars/font-awesome/6.4.0/css/all.min.css}"/>

    <!-- Custom CSS -->
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/css/custom-style.css}"/>

    <!-- Third-party CSS -->
    <link th:href="@{/assets/libs/jquery.filer/css/jquery.filer.css}" rel="stylesheet"/>
    <link th:href="@{/assets/libs/jquery.filer/css/themes/jquery.filer-dragdropbox-theme.css}" rel="stylesheet"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/datatables/datatables.min.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/sweetalert2/sweetalert2.min.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/toastr/toastr.min.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/bootstrap-select/css/bootstrap-select.min.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/summernote/summernote.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/summernote/summernote.min.js}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/select2/css/select2.min.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/magnific-popup/css/magnific-popup.css}">
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/nestable/jquery.nestable.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/bootstrap-datetimepicker/bootstrap-datetimepicker.min.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/bootstrap-daterangepicker/daterangepicker.css}"/>
    <link th:rel="stylesheet" type="text/css" th:href="@{/assets/libs/jquery-ui/jquery-ui.min.css}"/>

    <script th:inline="javascript">
        /*<![CDATA[*/
        var maximumSessionTimeout = /*[[${configuration.maximumSessionTimeout}]]*/ '1800';
        var homeUrl = /*[[${configuration.homeUrl}]]*/ '';

        var messageExecutedSuccessfully = /*[[#{message.executed.successfully}]]*/ '';
        var messageLoading = /*[[#{message.loading}]]*/ '';
        var offlineTitle = /*[[#{message.offline.title}]]*/ '';
        var offlineMessage = /*[[#{message.offline.message}]]*/ '';
        var pageNotFoundTitle = /*[[#{message.page.404.title}]]*/ '';
        var pageNotFoundMessage = /*[[#{message.page.404.message}]]*/ '';
        var forbiddenTitle = /*[[#{message.forbidden.title}]]*/ '';
        var forbiddenMessage = /*[[#{message.forbidden.message}]]*/ '';
        var sessionExpiredTitle = /*[[#{message.session.expired.title}]]*/ '';
        var sessionExpiredMessage = /*[[#{message.session.expired.message}]]*/ '';
        var internalServerErrorTitle = /*[[#{message.internal.error}]]*/ '';
        var somethingWentWrongTitle = /*[[#{message.something.went.wrong}]]*/ '';
    </script>

    <style>
        :root {
            --bs-primary: #3498db;
            --bs-secondary: #2c3e50;
            --bs-success: #2ecc71;
            --bs-info: #3498db;
            --bs-warning: #f39c12;
            --bs-danger: #e74c3c;
            --bs-light: #ecf0f1;
            --bs-dark: #2c3e50;
        }

        .swal2-popup {
            font-size: 1.5rem;
        }

        /* Custom styles */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
        }

        .wrapper {
            min-height: calc(100vh - 60px);
            padding-top: 1rem;
        }

        /* Context menu styles */
        #context-menu-holder {
            position: absolute;
            z-index: 1050;
            display: none;
        }
    </style>
</head>

<body>
<!-- Global table menu, right click-->
<ul id="context-menu-holder" class="dropdown-menu shadow-sm" role="menu">
    <!-- Content will be loaded dynamically -->
</ul>

<!-- Header section -->
<div th:remove="tag" sec:authorize="isAuthenticated()" th:replace="~{fragments/header :: header}"></div>

<!-- Main content wrapper -->
<div class="wrapper container-fluid">
    <div id="content" class="mt-3"></div>
</div>

<!-- Session timeout component -->
<th:block th:replace="~{fragments/session_timeout :: sessionTimeout}"/>

<!-- jQuery and core JS libraries -->
<script th:src="@{/webjars/jquery/3.7.1/jquery.min.js}"></script>
<script th:src="@{/webjars/jquery-migrate/3.3.2/jquery-migrate.min.js}"></script>

<!-- Bootstrap 5 Bundle JS (includes Popper) -->
<script th:src="@{/webjars/bootstrap/5.3.6/dist/js/bootstrap.bundle.min.js}"></script>

<!-- Core utility scripts -->
<script th:src="@{/assets/js/jquery.blockUI.js}"></script>
<script th:src="@{/assets/js/jquery.slimscroll.js}"></script>
<script th:src="@{/assets/js/jquery.scrollTo.min.js}"></script>

<!-- Third-party plugins -->
<script th:src="@{/assets/libs/datatables/jquery.dataTables.min.js}"></script>
<script th:src="@{/assets/libs/datatables/dataTables.bootstrap5.min.js}"></script>
<script th:src="@{/assets/libs/sweetalert2/sweetalert2.min.js}"></script>
<script th:src="@{/assets/libs/toastr/toastr.min.js}"></script>
<script th:src="@{/assets/libs/bootstrap-select/js/bootstrap-select.min.js}"></script>
<script th:src="@{/assets/libs/autoNumeric/autoNumeric.min.js}"></script>
<script th:src="@{/assets/libs/summernote/summernote-bs5.min.js}"></script>
<script th:src="@{/assets/libs/select2/js/select2.min.js}"></script>
<script th:src="@{/assets/libs/magnific-popup/js/jquery.magnific-popup.min.js}"></script>
<script th:src="@{/assets/libs/nestable/jquery.nestable.js}"></script>
<script th:src="@{/assets/libs/jquery.filer/js/jquery.filer.min.js}"></script>
<script th:src="@{/assets/libs/bootstrap-datetimepicker/moment-with-locales.min.js}"></script>
<script th:src="@{/assets/libs/bootstrap-datetimepicker/bootstrap-datetimepicker.min.js}"></script>
<script th:src="@{/assets/libs/bootstrap-daterangepicker/daterangepicker.js}"></script>
<script th:src="@{/assets/libs/moment/moment.js}"></script>
<script th:src="@{/assets/libs/jquery-ui/jquery-ui.min.js}"></script>

<!-- App specific JS -->
<script th:src="@{/assets/js/app.js}"></script>
<script th:src="@{/assets/js/appEdition.js}"></script>
<script th:src="@{/assets/js/sessionTimeout.js}"></script>

<script>
    $(document).click(function() {
        if ($("#context-menu-holder").css('display') === 'block') {
            $("#context-menu-holder").hide();
        }
    });

    $(document).ready(function() {
        var url = window.location.href.toString();
        if (!url.endsWith('#')) {
            loadingPage(url);
        } else {
            window.location.replace(homeUrl);
        }
    });

    window.addEventListener('popstate', function(event) {
        var pageUrl = window.location.href.toString();
        if (pageUrl.endsWith('#')) {
            pageUrl = homeUrl + "?dashboard";
        }
        loadingPage(pageUrl);
    });

    function loadingPage(pageUrl) {
        if (pageUrl.includes("#")) {
            pageUrl = pageUrl.replace("#", "/")
        } else {
            pageUrl = homeUrl + "?dashboard";
        }
        if (pageUrl.endsWith('/')) {
            pageUrl = pageUrl.slice(0, -1);
        }
        loadPageWithUrl(pageUrl);
    }
</script>

<script th:inline="javascript" th:if="${result != null}">
    /*<![CDATA[*/
    var isSuccess = /*[[${result.success}]]*/ '';
    var message = /*[[${result.message}]]*/ '';
    /*]]>*/
    if (isSuccess === false) {
        toast(message);
    } else {
        Swal.fire({
            title: messageExecutedSuccessfully,
            html: message,
            icon: 'success'
        })
    }
</script>
</body>
</html>